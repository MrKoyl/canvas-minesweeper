!function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);var i={VALIDATES:{size:{min:10,max:100},difficulty:{min:1,max:5}},IMAGES:{mine:"mine.png",grass:"grass.png"}};function r(e,t,n,r){const o={mine:new Image,grass:new Image};Object.keys(o).forEach(e=>{o[e].src=`./assets/${i.IMAGES[e]}`,o[e].onload=()=>console.log(`${e} loaded`)});const l=e.getContext("2d"),f=45;return e.onclick=e=>t({x:parseInt(e.offsetX/f),y:parseInt(e.offsetY/f)}),e.oncontextmenu=e=>n({x:parseInt(e.offsetX/f),y:parseInt(e.offsetY/f)}),e.ondblclick=e=>r({x:parseInt(e.offsetX/f),y:parseInt(e.offsetY/f)}),{initialDraw(t){e.width=t.width*f,e.height=t.height*f,function(e){l.drawImage(o.grass,1,1,1e3,1e3);for(let i=0;i<e.height;i++)for(let r=0;r<e.width;r++)t=r,n=i,l.fillStyle="black",l.fillRect(t*f,n*f,f,f),l.drawImage(o.grass,t*f+1,n*f+1,f-2,f-2);var t,n}(t)},gameDraw(e){e.map((e,t)=>e.map((e,n)=>{e.show?(l.fillStyle="white",l.fillRect(n*f+1,t*f+1,f-2,f-2),e.number&&(l.fillStyle="black",l.font=`${f/2}px serif`,l.fillText(e.number,(n+.5)*f+1,(t+.5)*f+1,f-2,f-2))):e.protected?(l.fillStyle="yellow",l.fillRect(n*f+1,t*f+1,f-2,f-2)):l.drawImage(o.grass,n*f+1,t*f+1,f-2,f-2)}))},showBombs(e){e.map((e,t)=>e.map((e,n)=>{e.mine&&l.drawImage(o.mine,n*f+1,t*f+1,f-2,f-2)}))},redrawCell(e,t,n){n.show?(l.fillStyle="white",l.fillRect(e*f+1,t*f+1,f-2,f-2),n.number&&(l.fillStyle="black",l.font=`${f/2}px serif`,l.fillText(n.number,(e+.5)*f+1,(t+.5)*f+1,f-2,f-2))):n.protected?(l.fillStyle="yellow",l.fillRect(e*f+1,t*f+1,f-2,f-2)):l.drawImage(o.grass,e*f+1,t*f+1,f-2,f-2)}}}const o=10,l=e=>e<=i.VALIDATES.size.max&&e>=i.VALIDATES.size.min;function f(e){const t=e*o;return l(t)?{width:t,height:t}:{width:i.VALIDATES.size.min,height:i.VALIDATES.size.min}}function m(e){return e.every(e=>e.every(e=>e.show||e.mine))}const c=new function(e){const t=new r(e,(function(e){a&&(u&&(t.initialDraw(n),c=function(e,t,n){let i=parseInt(e.width*e.height*(t/10));const r=[...Array(e.height)].map(()=>[...Array(e.width)].map(()=>({number:0,mine:!1,show:!1,protected:!1}))),o=(e,t,n)=>!1===r[t][e].mine&&(e>n.x+1||e<n.x-1||t>n.y+1||t<n.y-1);for(let t=0;t<1e4&&i;t++){let t=parseInt(Math.random()*e.width),l=parseInt(Math.random()*e.height);o(t,l,n)&&(r[l][t].mine=!0,i--)}return r}(n,o,e),function(e){const t=(e,t,n)=>{let i=0;for(let r=n-1;r<=n+1;r++)for(let o=t-1;o<=t+1;o++)e[r]&&e[r][o]&&(r!==n||o!==t)&&(i+=+e[r][o].mine);return i};for(let n=0;n<e.length;n++)for(let i=0;i<e[n].length;i++)e[n][i].number=t(e,i,n)}(c),u=!1,d=parseInt(n.width*n.height*(o/10)),document.getElementById("bombs").innerText=d),s(e.x,e.y),m(c)&&(a=!1,alert("VICTORY!!!")))}),(function(e){c&&!1===c[e.y][e.x].show&&a&&(c[e.y][e.x].protected?(c[e.y][e.x].protected=!1,d++):d>0&&(c[e.y][e.x].protected=!0,d--),t.gameDraw(c),document.getElementById("bombs").innerText=d)}),(function(e){if(c[e.y][e.x].number&&a){let t=0;for(let n=e.y-1;n<=e.y+1;n++)for(let i=e.x-1;i<=e.x+1;i++)c[n]&&c[n][i]&&(n!==e.y||i!==e.x)&&c[n][i].protected&&t++;if(t===c[e.y][e.x].number)for(let t=e.y-1;t<=e.y+1;t++)for(let n=e.x-1;n<=e.x+1;n++)c[t]&&c[t][n]&&(t!==e.y||n!==e.x)&&!1===c[t][n].protected&&s(n,t);m(c)&&(a=!1,alert("VICTORY!!!"))}}));let n,o,c,d,u=!1,a=!1;function s(e,n){if(a){if(!1===c[n][e].show&&!0!==c[n][e].protected)if(c[n][e].mine)a=!1;else if(c[n][e].show=!0,void 0===c[n][e].number||0===c[n][e].number)for(let t=n-1;t<=n+1;t++)for(let i=e-1;i<=e+1;i++)c[t]&&c[t][i]&&(t!==n||i!==e)&&s(i,t);t.redrawCell(e,n,c[n][e]),a||t.showBombs(c)}}return{newGame:(e=2,r=1,m)=>{n=0===r?function(e){return l(e.width)&&l(e.height)?e:f(0)}(m):f(r),o=function(e){return e>=i.VALIDATES.difficulty.min&&e<=i.VALIDATES.difficulty.max?e:i.VALIDATES.difficulty.min}(e),t.initialDraw(n),u=!0,a=!0}}}(document.getElementById("gameCanvas"));document.oncontextmenu=e=>e.preventDefault(),document.ondblclick=e=>e.preventDefault(),document.getElementById("newGame").onclick=()=>c.newGame(+document.getElementById("diff").innerText,+document.getElementById("size").innerText/10),document.getElementById("size-").onclick=()=>{document.getElementById("size").innerText=+document.getElementById("size").innerText>i.VALIDATES.size.min+10?+document.getElementById("size").innerText-10:i.VALIDATES.size.min},document.getElementById("size+").onclick=()=>{document.getElementById("size").innerText=+document.getElementById("size").innerText<i.VALIDATES.size.max?+document.getElementById("size").innerText+10:i.VALIDATES.size.max},document.getElementById("diff-").onclick=()=>{document.getElementById("diff").innerText=+document.getElementById("diff").innerText>i.VALIDATES.difficulty.min+1?+document.getElementById("diff").innerText-1:i.VALIDATES.difficulty.min},document.getElementById("diff+").onclick=()=>{document.getElementById("diff").innerText=+document.getElementById("diff").innerText<i.VALIDATES.difficulty.max?+document.getElementById("diff").innerText+1:i.VALIDATES.difficulty.max}}]);